(in-package #:lisphys)

(defsuite Quaternion3adSuite (LisPhysSuite))

(deftest test-quaternion3ad-setf (Quaternion3adSuite)
    (let ((v1 (make-instance 'quaternionad :x 1.0 :y 2.0 :z 3.0 :w 4.0))) 
    (progn 
      (assert-equal '(1.0 0.0) (quat-x v1))
      (assert-equal '(2.0 0.0) (quat-y v1))
      (assert-equal '(3.0 0.0) (quat-z v1))
      (assert-equal '(4.0 0.0) (quat-w v1))
      (setf (quat-x v1) 11.0)
      (setf (quat-y v1) 12.0)
      (setf (quat-z v1) 13.0)
      (setf (quat-w v1) 14.0)
      (assert-equal '(11.0 0.0) (quat-x v1))
      (assert-equal '(12.0 0.0) (quat-y v1))
      (assert-equal '(13.0 0.0) (quat-z v1))
      (assert-equal '(14.0 0.0) (quat-w v1))
      (setf (quat-x v1) '(11.0 1.0))
      (setf (quat-y v1) '(12.0 1.0))
      (setf (quat-z v1) '(13.0 1.0))
      (setf (quat-w v1) '(14.0 1.0))
      (assert-equal '(11.0 1.0) (quat-x v1))
      (assert-equal '(12.0 1.0) (quat-y v1))
      (assert-equal '(13.0 1.0) (quat-z v1))
      (assert-equal '(14.0 1.0) (quat-w v1))
      )
    ))

(run-suite 'Quaternion3adSuite)
